# Maintainer: s8321414 <s8321414 at gmail.com>
# Arch Linux maintainers and contributors:
# Maintainer: Igor Isaias Banlian <igorisaiasbanlian[at]gmail[dot]com>
# Contributor: Michael HÃ¤sel <michael[dot]haesel[at]gmail[dot]com>
# Contributor: Daniel Aguayo <daniel[at]varpub[dot]org>
# Contributor: Jaroslav Lichtblau <dragonlord[at]aur[dot]archlinux[dot]org>
# Contributor: Eric Belanger <eric[at]archlinux[dot]org>
# Contributor: Angelo Theodorou <encelo[at]users[dot]sourceforge[dot]net>

pkgname=ffmpeg2theora
pkgver=0.29
pkgrel=3
pkgdesc="A simple converter to create Ogg Theora files."
arch=('x86_64')
url="http://www.v2v.cc/~j/ffmpeg2theora/"
license=('GPLv2')
depends=('ffmpeg')
makedepends=('scons')
source=(http://www.v2v.cc/~j/${pkgname}/downloads/${pkgname}-${pkgver}.tar.bz2
	ffmpeg2theora-0.29-underlinking.patch)
sha512sums=('5e5cf1dbc6807a15b3a3e8526955ef341357b6a3106a6449a54b5dc09c652a9df34b5e93c9cbf05e1efad87542364cb8335e173a59a184aa2ff38ec4b536a725'
            'a9c16e115d72400cd29c60e9893b89e37a1c4800edebc23ebd576c47b49c37ec69e31fe2de4bef50a32c1f60a1be5df5dae2b62000e8f558b30c440938652632')

prepare() {
  cd "${srcdir}"/$pkgname-$pkgver

  echo "#define AVCODEC_MAX_AUDIO_FRAME_SIZE 192000" >> src/ffmpeg2theora.h
  patch -p0 -i ../ffmpeg2theora-0.29-underlinking.patch
}

build() {
  cd "${srcdir}"/$pkgname-$pkgver

  scons
}

package() {
  cd "${srcdir}"/$pkgname-$pkgver

  scons install destdir="${pkgdir}" prefix="/usr" mandir="PREFIX/share/man"
}
